<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../viewer-param/viewer-param.html">
<link rel="import" href="../html-echo/html-echo.html">

<dom-module id="viewer-type">
  <template>
    <div>
      <h4 class="type-name monospace"><span>{{name}}</span><a href$="{{url}}"><iron-icon icon="icons:link"></iron-icon></a></h4>

      <p class="type-description"><html-echo html="{{description}}"></html-echo></p>
      <p class="type-type">Type: <strong>{{type}}</strong></p>

      <h5 hidden="{{isEmpty(objectProperties)}}">Properties</h5>
      <dl class="parameter-list" hidden="{{isEmpty(objectProperties)}}">
        <template is="dom-repeat" items="{{objectProperties}}" as="property">
          <viewer-param
            name="{{property.name}}"
            description="{{property.description}}"
            optional="{{property.optional}}"
            type="{{property.type}}"
            ref="{{property.$ref}}"></viewer-param>
        </template>
      </dl>

      <h5 hidden="{{isEmpty(allowedValues)}}">Allowed values</h5>
      <p hidden="{{isEmpty(allowedValues)}}">{{joinValues(allowedValues)}}</p>
    </div>
  </template>
  <style>
    .parameter-list{
      border: 2px solid hsl(0, 0%, 85%);
      border-radius: 5px;
      margin: 0 10%;
    }

    h4 a {
      color: var(--accent-color);
      padding-left: 5px;
      opacity: 0;
      transition: opacity 300ms;
    }

    h4:hover a {
      opacity: 1;
    }

    @media (max-width: 980px) {
      .parameter-list{
        margin: 0;
      }
    }

  </style>
</dom-module>
<script>
  Polymer({
    is: 'viewer-type',
    properties: {
      name: String,
      description: String,
      type: String,
      objectProperties: Object,
      allowedValues: Object,
      arrayItems: Object
    },
    ready: function() {
      this.objectProperties = null;
      this.allowedValues = null;
      this.arrayItems = null;
    },
    isEmpty: function(paramObj){
      return !paramObj || !paramObj.length;
    },
    joinValues: function(array) {
      return array && Array.isArray(array) && array.join(', ');
    }
  });
</script>
